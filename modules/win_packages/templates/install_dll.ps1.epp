$Path = "<%= $path %>"

## install the DLL
$process = Start-Process -FilePath "regsvr32.exe" -ArgumentList "/s $path" -Wait -NoNewWindow -PassThru

## validate the install
$results = Get-ChildItem -Path HKLM:\SOFTWARE\Classes\CLSID -Recurse -ErrorAction SilentlyContinue | Where-Object {
    (Get-ItemProperty -Path $_.PSPath -ErrorAction Stop)."(default)" -eq $path
}

if (-Not ([string]::IsNullOrEmpty($results))) {
    exit 0
}
else {
    exit 1
}
